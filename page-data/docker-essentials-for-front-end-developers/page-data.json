{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/docker-essentials-for-front-end-developers/","result":{"data":{"site":{"siteMetadata":{"title":"NoSleep Javascript Blog"}},"markdownRemark":{"id":"fb1f7f1f-8f37-5b05-90cf-a4390c014132","excerpt":"Jump to the commands sections What is docker? Docker is an open platform for developing, shipping, and running applications. source Docker lets you encapsulate…","html":"<p>Jump to the <a href=\"#essential-commands\">commands sections</a></p>\n<h2 id=\"what-is-docker\" style=\"position:relative;\">What is docker?<a href=\"#what-is-docker\" aria-label=\"what is docker permalink\" class=\"header-anchor after\">#</a></h2>\n<blockquote>\n<p>Docker is an open platform for developing, shipping, and running applications.</p>\n<p><a href=\"https://docs.docker.com/engine/docker-overview/\">source</a></p>\n</blockquote>\n<p><a href=\"https://www.docker.com/\">Docker</a> lets you encapsulate your application along with all its\nsystem dependencies into a single executable\nthat can be shipped predictably into servers or clusters; or\nas development environment for other developers using different\nOperating Systems.</p>\n<p>If you are familiar with Virtual Machines (such as <a href=\"https://www.virtualbox.org\">Virtual Box</a>) or <a href=\"https://www.vagrantup.com\">Vagrant</a>\nthen you should feel comfortable enough with Docker.</p>\n<p>With Docker you can easily create something very similar to a headless virtual machine.\nYou can install system dependencies, configure networks and ports, setup databases,\nfetch your code and start your app with a simple configuration file i.e. <em>Dockerfile</em>.</p>\n<p>Today it’s very common for <a href=\"https://en.wikipedia.org/wiki/Infrastructure_as_a_service\">IaaS</a> and <a href=\"https://en.wikipedia.org/wiki/Platform_as_a_service\">PaaS</a> providers to provide first\nclass support for Docker containers.\nExamples of these providers are <a href=\"https://cloud.google.com/compute\">Google Cloud Compute Engine</a>,\n<a href=\"https://azure.microsoft.com/en-us/\">Microsoft Azure</a> and <a href=\"https://aws.amazon.com\">Amazon AWS</a> among others.\nYou can use <a href=\"https://kubernetes.io/\">Kubernetes</a> to manage a cluster composed of dozens\nof Docker containers in these providers and scale easily\nso long as you can afford it.</p>\n<p>Lets take a simple Nodejs / Front End application, what does it need to run?</p>\n<ul>\n<li>\n<p>System Dependencies:</p>\n<ul>\n<li>An adequate linux distribution.</li>\n<li><a href=\"https://nodejs.org/en/\">NodeJs</a>, <a href=\"https://www.npmjs.com/\">NPM</a>, <a href=\"https://yarnpkg.com/\">Yarn</a>.</li>\n<li><a href=\"https://gcc.gnu.org/\">gcc</a> and the required native dependencies to install native NodeJs dependencies (such as <code class=\"language-text\">node-sass</code>).</li>\n</ul>\n</li>\n<li>\n<p>System configurations:</p>\n<ul>\n<li>npm/yarn repositories.</li>\n<li>OS networks, users, groups, etc.</li>\n<li>System optimizations such as removing any OS components not needed for running your app.</li>\n</ul>\n</li>\n<li>\n<p>build/run steps:</p>\n<ul>\n<li>fetching your app’s code</li>\n<li>installing dependencies (i.e. via <code class=\"language-text\">yarn install</code> or <code class=\"language-text\">npm install</code>)</li>\n<li>building (if necessary)</li>\n<li>starting your app</li>\n</ul>\n</li>\n</ul>\n<p>We will a cover an example of this later.</p>\n<p>Docker lets you express all these necessary steps that make\nup a single deliverable application.</p>\n<p>The way you express these necessary steps is a <strong>Dockerfile</strong>\nand the result of <em>building</em> your <em>Dockerfile</em>\nis an <strong>Image</strong> that can be instantiated and executed, this executable\nis called a <strong>Container</strong>.</p>\n<h2 id=\"what-is-an-image\" style=\"position:relative;\">What is an image?<a href=\"#what-is-an-image\" aria-label=\"what is an image permalink\" class=\"header-anchor after\">#</a></h2>\n<blockquote>\n<p>An image is a read-only template with instructions for creating a Docker container.</p>\n<p><a href=\"https://docs.docker.com/engine/docker-overview/\">source</a></p>\n</blockquote>\n<p>You use a <em>Dockerfile</em> to define an <em>image</em>.</p>\n<p>Your <em>Dockerfile</em> is an ordered list of steps necessary to\nrun your app. Each line will generate an intermediate <em>image</em> that\nDocker will cache for performance reasons, so the order of your\nsteps is important.</p>\n<p>This is a rather minimal but typical <em>Dockerfile</em> for a NodeJs app:</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token comment\"># This is our base community provided image,</span>\n<span class=\"token comment\"># with some minimal distribution of linux</span>\n<span class=\"token comment\"># that comes with NodeJs v10 (and npm) already installed</span>\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> node:12</span>\n\n<span class=\"token comment\"># Use this directory _inside_ your Docker container</span>\n<span class=\"token comment\"># as the base directory of all the next actions</span>\n<span class=\"token instruction\"><span class=\"token keyword\">WORKDIR</span> /usr/src/app</span>\n\n<span class=\"token comment\"># Copy your app's code from the host (your computer) to the container.</span>\n<span class=\"token comment\"># This assumes a typical setup in which the Dockerfile</span>\n<span class=\"token comment\"># is in the root of your project</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> package.json ./</span>\n\n<span class=\"token comment\"># Install dependencies</span>\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> npm install</span>\n\n<span class=\"token comment\"># Copy the rest of your App's source files</span>\n<span class=\"token instruction\"><span class=\"token keyword\">COPY</span> . .</span>\n\n<span class=\"token comment\"># Tell Docker that your app will be working in the port 8080</span>\n<span class=\"token comment\"># so we should open it up to the outside</span>\n<span class=\"token instruction\"><span class=\"token keyword\">EXPOSE</span> 8080</span>\n\n<span class=\"token comment\"># Run your app.</span>\n<span class=\"token comment\"># CMD signals Docker that this is the thing that we want to run,</span>\n<span class=\"token comment\"># if this executable fails then the whole container will exit.</span>\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [ <span class=\"token string\">\"node\"</span>, <span class=\"token string\">\"server.js\"</span> ]</span></code></pre></div>\n<p>Notice how we install dependencies before copying the App’s code, this assumes\nthat the dependencies will change less frequently that the App code so Docker might\nbe able to use the already cached intermediate <em>image</em> up to that point.</p>\n<p>Building <em>images</em> means processing the list of instructions and sort of <em>render</em> the final <em>image</em>\nso that it is ready to be instantiated into a running <em>container</em>.</p>\n<p><strong>IMPORTANT</strong>: <strong>Images</strong> are just instructions, when you run them you turn them into <strong>Containers</strong>.</p>\n<h2 id=\"what-is-a-container\" style=\"position:relative;\">What is a container?<a href=\"#what-is-a-container\" aria-label=\"what is a container permalink\" class=\"header-anchor after\">#</a></h2>\n<blockquote>\n<p>A container is a runnable instance of an image.</p>\n<p><a href=\"https://docs.docker.com/engine/docker-overview/\">source</a></p>\n</blockquote>\n<p>After you built your final <em>image</em> you can then instantiate it into an executable,\nthis executable is called a <em>container</em> and it is treated\nby your host OS as just another process.</p>\n<p>Take a moment to think about the big leap of the final statement,\nthis means that by using Docker you have encapsulated an\nentire Operating System (OS), dependencies, configurations,\nstartup commands, etc into a single runnable process in your\nhost Operating System. Nice, right?</p>\n<h2 id=\"image-vs-container-an-analogy\" style=\"position:relative;\">Image vs Container: an analogy<a href=\"#image-vs-container-an-analogy\" aria-label=\"image vs container an analogy permalink\" class=\"header-anchor after\">#</a></h2>\n<p>You can think of an <em>image</em> as a traditional Object Oriented Programming (OOP) Class,\nand a <em>container</em> as an instance.\nYou can have multiple running instances of an image\n(that is usually how you scale your app inside a cluster), with\nslightly different parameters (Environment Variables mostly).</p>\n<p><code class=\"language-text\">Images</code> can inherit from other <code class=\"language-text\">images</code> to compose them in useful and meaningful ways.</p>\n<h2 id=\"docker-repositories-docker-hub\" style=\"position:relative;\">Docker repositories (Docker Hub)<a href=\"#docker-repositories-docker-hub\" aria-label=\"docker repositories docker hub permalink\" class=\"header-anchor after\">#</a></h2>\n<blockquote>\n<p>Docker Hub repositories allow you share container images with your team, customers, or the Docker community at large.</p>\n<p><a href=\"https://docs.docker.com/docker-hub/repos/\">source</a></p>\n</blockquote>\n<p>Docker Hub is an analogue solution to things such as NPM to distribute NodeJs packages,\n<a href=\"https://doc.rust-lang.org/cargo/\">Cargo</a> to distribute <a href=\"https://www.rust-lang.org/\">Rust</a> crates (pieces of code), <a href=\"https://maven.apache.org/\">Maven</a> to distribute <a href=\"https://en.wikipedia.org/wiki/Java_(software_platform)\">Java</a> Jars (pieces of code), etc.</p>\n<p>Docker hub also has the concept of <a href=\"https://docs.docker.com/registry/deploying/\">registry</a> similar to NPM where you can use\nthe default Docker hub registry or your company’s own.\nThe default <a href=\"https://www.docker.com/products/docker-hub\">Docker hub registry</a> is where most of the base images, such as NodeJs,\nNginx, Java, etc live.</p>\n<p>In the <code class=\"language-text\">Dockerfile</code> we dissected before, the first line is <code class=\"language-text\">FROM node:12</code> and\ntells docker to use the base image <code class=\"language-text\">node:12</code> (NodeJs version 12) that is stored\nin a Docker hub registry, by default it will use Docker’s registry.</p>\n<p>The first time you try to build this image you will notice that Docker\ndownloads the base image and store it in cache.</p>\n<p>We cover the basic commands in the next section.</p>\n<h2 id=\"essential-commands\" style=\"position:relative;\">Essential commands<a href=\"#essential-commands\" aria-label=\"essential commands permalink\" class=\"header-anchor after\">#</a></h2>\n<p>This assumes you have docker installed in your system (Linux or Macos)</p>\n<h3 id=\"building\" style=\"position:relative;\">Building<a href=\"#building\" aria-label=\"building permalink\" class=\"header-anchor after\">#</a></h3>\n<p>Build your docker image (from a <em>Dockerfile</em> in the current directory).\nDocker will output the <code class=\"language-text\">Image Id</code> if everything goes well. This will be used\nto instantiate the <em>image</em> later.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker build <span class=\"token builtin class-name\">.</span>\n<span class=\"token comment\"># equivalent to</span>\ndocker build ./Dockerfile</code></pre></div>\n</br>\n<p>Use <code class=\"language-text\">tags</code> to easily reference the built image, this replaced the need to use <code class=\"language-text\">Image Id</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker build -t mySuperApp <span class=\"token builtin class-name\">.</span></code></pre></div>\n</br>\n<p>Force docker to re-build your <code class=\"language-text\">image</code>. Typically this is used when you changed something\nin your Dockerfile, or the base image has changed.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker build --no-cache <span class=\"token builtin class-name\">.</span></code></pre></div>\n</br>\n<p>Check the built images in your system</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker image <span class=\"token function\">ls</span></code></pre></div>\n</br>\n<p>All the build commands output the docker <code class=\"language-text\">Image id</code> which is something you can use when\ninstantiating them into <code class=\"language-text\">containers</code>, but using a <code class=\"language-text\">tag</code> is a much more human friendly way.</p>\n<h3 id=\"docker-hub\" style=\"position:relative;\">Docker hub<a href=\"#docker-hub\" aria-label=\"docker hub permalink\" class=\"header-anchor after\">#</a></h3>\n<p>Push your most recently built image to docker hub using the tag as identifier.\nTags can have a complex form to keep track of versions and such.\nSome common patterns are:</p>\n<ul>\n<li><code class=\"language-text\">name-of-my-app:LATEST</code>: the latest version of your app, will keep changing as new versions come.</li>\n<li><code class=\"language-text\">name-of-my-app:VERSION</code>: a given version of your app.</li>\n<li><code class=\"language-text\">nodejs:10</code>: the base NodeJs v10 image.</li>\n</ul>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker push <span class=\"token variable\">$TAG</span></code></pre></div>\n</br>\n<h3 id=\"running\" style=\"position:relative;\">Running<a href=\"#running\" aria-label=\"running permalink\" class=\"header-anchor after\">#</a></h3>\n<p>Instantiate an <code class=\"language-text\">image</code> either by <code class=\"language-text\">Image Id</code> or by <code class=\"language-text\">tag</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run <span class=\"token variable\">$IMAGE_ID</span>\n\ndocker run <span class=\"token variable\">$TAG</span></code></pre></div>\n</br>\n<h3 id=\"debugging\" style=\"position:relative;\">Debugging<a href=\"#debugging\" aria-label=\"debugging permalink\" class=\"header-anchor after\">#</a></h3>\n<p>These commands are very useful for debugging your container, image or\nApplication.</p>\n<p>Instantiate the <code class=\"language-text\">image</code> into a <code class=\"language-text\">container</code> and replace the <code class=\"language-text\">CMD</code> in the <em>Dockerfile</em> for\nan interactive shell you can play around with. This is particularly useful when your app\nfails to start, you can ssh into the container and manually start the app or make some debugging.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -ti <span class=\"token variable\">$IMAGEID_OR_TAG</span> <span class=\"token function\">bash</span></code></pre></div>\n</br>\n<p>Run a <code class=\"language-text\">container</code> that uses your host’s (your machine) App directory and files.\nThis allows you to use your regular development tools such as IDEs or Text Editors\nto edit your <code class=\"language-text\">container</code>’s files in place. This is particularly useful when debugging\nyour App running inside a container.\n<code class=\"language-text\">$PWD</code> is your process working directory or the directory you are currently located in your shell instance,\nin this case we assume is your App’s root directory.\nYour container <code class=\"language-text\">WORKDIR</code> should be the one you set in your <em>Dockerfile</em>.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker run -ti -v <span class=\"token environment constant\">$PWD</span>:your-container-workdir <span class=\"token variable\">$IMAGEID_OR_TAG</span> <span class=\"token function\">bash</span></code></pre></div>\n<p><strong>Note</strong> if you get an error about <code class=\"language-text\">bash</code> not being found then try using <code class=\"language-text\">/bin/bash</code></p>\n</br>\n<p>SSH into an already running container.\nUseful for debugging a partially running <code class=\"language-text\">container</code> or <code class=\"language-text\">app</code> or\nfor tweaking some details of your <code class=\"language-text\">container</code> or <code class=\"language-text\">app</code>.\nMost of the time I use the previous ones since I find them more useful.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token builtin class-name\">exec</span> -ti <span class=\"token variable\">$CONTAINER_ID</span> /bin/bash</code></pre></div>\n</br>\n<h3 id=\"managing\" style=\"position:relative;\">Managing<a href=\"#managing\" aria-label=\"managing permalink\" class=\"header-anchor after\">#</a></h3>\n<p>What are the current running <code class=\"language-text\">containers</code>?</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token function\">ps</span></code></pre></div>\n</br>\n<p>Kill a running <code class=\"language-text\">container</code> (get the <code class=\"language-text\">$CONTAINER_ID</code> from the above output).</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker <span class=\"token function\">kill</span> <span class=\"token variable\">$CONTAINER_ID</span></code></pre></div>\n</br>\n<p>Check a <code class=\"language-text\">container</code>’s logs.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker logs <span class=\"token variable\">$CONTAINER_ID</span></code></pre></div>\n</br>\n<p>Inspect a <code class=\"language-text\">container</code> (debug information about volumes, networks, ports, etc about a given container).\nIn this case we get the <code class=\"language-text\">container</code>’s IP Address.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">docker inspect <span class=\"token punctuation\">\\</span>\n  --format<span class=\"token operator\">=</span><span class=\"token string\">'{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}'</span> <span class=\"token punctuation\">\\</span>\n  <span class=\"token variable\">$CONTAINER_ID</span></code></pre></div>\n</br>\n<p>Check the <a href=\"https://docs.docker.com/engine/reference/commandline/inspect/\">docs</a> for a more complete coverage.</p>\n<h2 id=\"closing\" style=\"position:relative;\">Closing<a href=\"#closing\" aria-label=\"closing permalink\" class=\"header-anchor after\">#</a></h2>\n<p>This is the basic knowledge I think every Front End developer should have as a minimum,\ngiven the fact that Docker has such a wide adoption. The commands are commands I use\non a daily basis in my day job.</p>\n<p>Even if you are not a Front End developer but simply new to this technology I think\nyou will be able to take value (and pride) from learning the basics.</p>\n<p>There is a lot to learn about Docker and you can base your whole career specializing\non Docker and its parent discipline: DevOps.</p>","fields":{"slug":"/docker-essentials-for-front-end-developers/","readingTime":{"text":"9 min read"}},"frontmatter":{"title":"Essential Docker for Javascript and Front End Developers","date":"March 10, 2020","description":"Docker has become a widely used technology and chances are you are going to have to deal with it eventually, at least superficially, in your Front End career. Let's cover the basic concepts and day to day useful commands you will likely use when dealing with Docker.","tags":["Docker","Dockerfile","Javascript","front end developers","NodeJs","Express","Cloud Computing","Clusters","Kubernetes","AWS","Azure","Google Compute Engine"],"seoFooter":null,"author":{"id":"franleplant","bio":"Tech Lead and Software developer with a degree in Engineering. Woodworker, all things Javascript, Rust and Software Architecture.","twitter":"franleplant","github":"https://github.com/franleplant","profilepicture":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACjUlEQVQ4y2P4jwH+/fsHJO/curV6xdKjhw9+//4NLogGGND4f//+BZKXL160MDVRUVLSUFZydbBbvHDBf2wAXfOfP3+AZENtjaWqVFGEx/L69HB7I3ERkUMHD8CNJmDzlo3rtrdn/Tww5/+p5Wtb8wUEBCZNnAA3GqdmiN9ePH86uTDmUG/h6vr0LT3Fdrqqpw8TYTNE89dPH84saL+3rPPlpinn5zcdn9Xw//sniDQ+zXCwdWLVqvL4iwtbTs6qPrd1KUgjqrXYNUMUndm9dk9P/obO/OkFYZeP7SVKM9DZf8GhcmDvriw/y3xvwy0tyetm9xw4fPT6tes/f/4iYDMwSJ88eRIREZ7oqDkh07cxL9HT1c3dw9va2nbv3v3IwcaAFlRv375taW0LDY2wtLZ0c7QzMzEys7T18w/KzMrOys5btmIlcmpjQNYJJFvbWgMCgyOjY3z9fH18/ULDIgoKivILimJi41NTUpOSU6/fuAm3nAE5bew9cNDR1T0qJiYkNAQIAgID0zOycnLzw8IjIyIiMzOz4uISdu3ag6IZYu3nz58mtdaWpkYFBwd4eXkFBASGhYUlJaeER0Z5eXsnJCSkpaVFRcVs2LABi+ZVyxafnVN3bUlzYrCHuZWVp6dHeHh4RGSUm7t7TEx0ampaRkYmMCw2bdqE0Ayhbt68GRcXN7+9/MrKnvq0MEtr26CgIP+AACtzE2cnR6CDMzKzkpJSQkPDb968hdAMSeuzZs92cnEODo+IiIqJjY2Ljo6JiYvPTolf3VGQnhgbGh4RFh7u6+tXXV2NHMBQzRMnTdTT03VydnRxdXVxdTMzM7GwsIgIDc5MjvPz9/f19fH29razs9+8eTNyPAMANpkgbLnsUSwAAAAASUVORK5CYII=","aspectRatio":1.1363636363636365,"src":"/static/3d0df698a9c84ca995878f7c2815d974/edb0e/franleplant-profile.png","srcSet":"/static/3d0df698a9c84ca995878f7c2815d974/69585/franleplant-profile.png 200w,\n/static/3d0df698a9c84ca995878f7c2815d974/497c6/franleplant-profile.png 400w,\n/static/3d0df698a9c84ca995878f7c2815d974/edb0e/franleplant-profile.png 620w","sizes":"(max-width: 620px) 100vw, 620px"}}}}}}},"pageContext":{"slug":"/docker-essentials-for-front-end-developers/","previous":{"fields":{"slug":"/package-react-components/"},"frontmatter":{"title":"How to share React Components between Applications via NPM"}},"next":{"fields":{"slug":"/intro-to-gamedev/"},"frontmatter":{"title":"Intro to game development with Typescript"}}}},"staticQueryHashes":["1000388668","1219926595","914163225"]}