{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/cardano-smart-contract-game/","result":{"data":{"site":{"siteMetadata":{"title":"NoSleep Javascript Blog"}},"markdownRemark":{"id":"8ad9d478-b551-5572-bd8e-937c7afd5de8","excerpt":"I’ve taken part of the second cohort of the Plutus Pioneer Program where one can\nlearn how to write Smart Contracts in Cardano by using Plutus, set for main…","html":"<p>I’ve taken part of the second cohort of the <a href=\"https://testnets.cardano.org/en/plutus-pioneer-program/\">Plutus Pioneer Program</a> where one can\nlearn how to write Smart Contracts in <a href=\"https://cardano.org/\">Cardano</a> by using <a href=\"https://github.com/input-output-hk/plutus\">Plutus</a>, set for main chain release in late 2021.</p>\n<p>Cardano’s version of Smart Contract is pretty “weird” coming from <a href=\"https://ethereum.org/en/\">Ethereum</a>,\nand I plan to write about it later but it does provide some interesting abstractions that let\nyou express common patterns rather easily, in particular we are going to be covering\nhow you can model your DApp as a state machine and how can you express said model in Plutus\npretty easily.</p>\n<p>Cardano’s Smart Contracts are written in a Haskell library called Plutus, so put up your\nfunctional programming hat and let’s get our hands dirty.</p>\n<p>Note: at the time of writing there still some wrinkles in Cardano’s smart contract platform, so\nif you are not part of the Plutus Pioneer Program you might have some difficulties running the code,\nbut hopefully it will be a nice showcase of how Cardano enables smart contracts.\nAlso, State Machines are just a higher level abstraction to write smart contracts in Cardano but\nnot at all the only way, so you are not limited to them.</p>\n<h2 id=\"quick-intro-to-plutus-concepts\" style=\"position:relative;\">Quick intro to Plutus Concepts<a href=\"#quick-intro-to-plutus-concepts\" aria-label=\"quick intro to plutus concepts permalink\" class=\"header-anchor after\">#</a></h2>\n<p>Plutus smart contracts should be called <strong>Smart Transactions</strong> because that is all you can really do <em>on-chain</em>.</p>\n<p>From the outside, users can only generate <strong>Transactions</strong> with inputs (UTxOs or unspent transaction outputs of previous\ntransactions) and generate outputs (also UTxOs) at different public key addresses depending on the use case.</p>\n<p>These transactions are created <em>off-chain</em> and sent along with a trivial payload\ncalled the <strong>Redeemer</strong>.</p>\n<p>A transaction is only applied to the blockchain after being <em>validated</em> by <strong>Validator script</strong>\nwhich is the main thing DApp developers write and run <em>on-chain</em>.</p>\n<p>This validator script has a public key address made up of its hash and\nfunds (UTxOs) can only be spent if the transaction trying to spend them\npasses the validation, which is the business logic running <em>on-chain</em>.</p>\n<p>A UTxO contains coins or Native Tokens plus a trivial custom payload called the <code class=\"language-text\">Datum</code>,\nwhich serves as a custom application state and is central to the ability to write DApps.</p>\n<p>The main difference between user accounts and script accounts is that\nuser accounts need to sign spending transactions with their private key but\nanyone can spend from a script address if the transaction is considered valid by the\nvalidator script itself. Is a pretty interesting model.</p>\n<p>All this is part of the EUTxO model or the Extended Unspect Transaction Output which is\nthe model pioneered by Bitcoin with some extensions to allow <em>smart contracts</em>.</p>\n<p>Surprisingly this model allows pretty much all what you would expect from a smart contract platform, it is just modeled\ndifferently and does comes with trade-offs. It is similar to what <code class=\"language-text\">functional programming</code> brings to the table in terms\nof predictability, testability and simpler interfaces comparing it to imperative or object oriented programming,\nso we could say that <strong>Cardano is a platform for pure functional smart contracts</strong>.</p>\n<h2 id=\"rock-paper-scissors\" style=\"position:relative;\">Rock Paper Scissors<a href=\"#rock-paper-scissors\" aria-label=\"rock paper scissors permalink\" class=\"header-anchor after\">#</a></h2>\n<p>We are going write the Rock Paper Scissors game but in the blockchain, I eventually will\nlike to really deploy it and add a nice UI on top of it.</p>\n<p>The model we are going to use makes the first player commit to a play but without telling exactly the\nplay by using a hash, then the second player plays, and finally the first player reveals and the “stake”\nor “bet” is distributed. There are also play deadlines and reveal deadlines to make the contract safe.</p>\n<p>Here is a complete state diagram of our game model.\nThe transitions are labeled with the <code class=\"language-text\">Redeemer</code> and its payload, constraints and checks.\nConstraints are common transaction constraints that Plutus provides abstractions for and\nchecks are anything else developers might want to check to allow or not a given state transition.\nIn our case we only use <code class=\"language-text\">checks</code> in the chase of <code class=\"language-text\">Player1RevealWin</code> and <code class=\"language-text\">Player1RevealDraw</code>, where\nwe check that effectively it is a win or a draw for Player1.\nThe state are composed of <code class=\"language-text\">Datum</code> which holds trivial data plus the staked / bet value.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/d90346e03181797b40d09b9e18171b09/98d66/states.jpg\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 131.0810810810811%; position: relative; bottom: 0; left: 0; background-image: url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAaABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABUBAQEAAAAAAAAAAAAAAAAAAAEA/9oADAMBAAIQAxAAAAHsSxNAMtFiq//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEAAQUCT//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQMBAT8BH//EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8BH//EABQQAQAAAAAAAAAAAAAAAAAAADD/2gAIAQEABj8CT//EABwQAAICAgMAAAAAAAAAAAAAAAABETEQIUFRsf/aAAgBAQABPyF9JlLbIPRTHEirY1TNQJQrwqx//9oADAMBAAIAAwAAABBAOjz/xAAWEQADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQMBAT8QdP/EABQRAQAAAAAAAAAAAAAAAAAAACD/2gAIAQIBAT8QH//EABsQAQADAQEBAQAAAAAAAAAAAAEAESExQRBR/9oACAEBAAE/EFa6KglG8BXWJlhxkWOhktT1AbPPydH17HAVEKc+n//Z'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"State transition function\"\n        title=\"State transition function\"\n        src=\"/static/d90346e03181797b40d09b9e18171b09/1c72d/states.jpg\"\n        srcset=\"/static/d90346e03181797b40d09b9e18171b09/a80bd/states.jpg 148w,\n/static/d90346e03181797b40d09b9e18171b09/1c91a/states.jpg 295w,\n/static/d90346e03181797b40d09b9e18171b09/1c72d/states.jpg 590w,\n/static/d90346e03181797b40d09b9e18171b09/a8a14/states.jpg 885w,\n/static/d90346e03181797b40d09b9e18171b09/fbd2c/states.jpg 1180w,\n/static/d90346e03181797b40d09b9e18171b09/98d66/states.jpg 1905w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<h2 id=\"on-chain-state-code-classlanguage-textdatumcode\" style=\"position:relative;\">On-chain state: <code class=\"language-text\">Datum</code><a href=\"#on-chain-state-code-classlanguage-textdatumcode\" aria-label=\"on chain state code classlanguage textdatumcode permalink\" class=\"header-anchor after\">#</a></h2>\n<p>As we said before, the <code class=\"language-text\">Datum</code> will be a trivial piece of data we are going to store <code class=\"language-text\">on-chain</code>.\nIn this particular case we are going to use it to store the current state of our state machine plus\nthe choices made by players.</p>\n<p><code class=\"language-text\">FinalState</code> will contain no <code class=\"language-text\">Datum</code> and no <code class=\"language-text\">value</code> (coins and Native Tokens)</p>\n<div class=\"gatsby-highlight\" data-language=\"haskell\"><pre class=\"language-haskell\"><code class=\"language-haskell\"><span class=\"token keyword\">data</span> <span class=\"token constant\">GameDatum</span> <span class=\"token operator\">=</span>\n      <span class=\"token comment\">-- at first we only store the hash of the player1's choice</span>\n      <span class=\"token constant\">State0</span> <span class=\"token constant\">ByteString</span>\n      <span class=\"token comment\">-- then we store the hash of the player1's choice plus the player2's choice</span>\n    <span class=\"token operator\">|</span> <span class=\"token constant\">State1</span> <span class=\"token constant\">ByteString</span>            <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>GameChoice</span>\n      <span class=\"token comment\">-- when resolving draws we store both choices unhashed</span>\n    <span class=\"token operator\">|</span> <span class=\"token constant\">State2</span> <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>GameChoice</span> <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>GameChoice</span>\n      <span class=\"token comment\">-- the final state stores nothing</span>\n    <span class=\"token operator\">|</span> <span class=\"token constant\">StateFinal</span>\n    <span class=\"token keyword\">deriving</span> <span class=\"token constant\">Prelude<span class=\"token punctuation\">.</span>Show</span></code></pre></div>\n<p><a href=\"https://github.com/franleplant/plutus-pioneer-program-fork/blob/rock-paper-scissors/code/week07/src/RPS/GameDatum.hs\">GameDatum.hs</a></p>\n<h2 id=\"transaction-validator-input-code-classlanguage-textredeemercode\" style=\"position:relative;\">Transaction validator input: <code class=\"language-text\">Redeemer</code><a href=\"#transaction-validator-input-code-classlanguage-textredeemercode\" aria-label=\"transaction validator input code classlanguage textredeemercode permalink\" class=\"header-anchor after\">#</a></h2>\n<div class=\"gatsby-highlight\" data-language=\"haskell\"><pre class=\"language-haskell\"><code class=\"language-haskell\"><span class=\"token keyword\">data</span> <span class=\"token constant\">GameRedeemer</span> <span class=\"token operator\">=</span>\n        <span class=\"token constant\">Player2Play</span>       <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>GameChoice</span>\n      <span class=\"token operator\">|</span> <span class=\"token constant\">Player2NoRevealClaim</span>\n      <span class=\"token operator\">|</span> <span class=\"token constant\">Player1RevealWin</span>  <span class=\"token constant\">ByteString</span> <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>GameChoice</span>\n      <span class=\"token operator\">|</span> <span class=\"token constant\">Player1RevealDraw</span> <span class=\"token constant\">ByteString</span> <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>GameChoice</span>\n      <span class=\"token operator\">|</span> <span class=\"token constant\">Player2ClaimDraw</span>\n      <span class=\"token operator\">|</span> <span class=\"token constant\">Player1NoPlayClaim</span>\n    <span class=\"token keyword\">deriving</span> <span class=\"token constant\">Prelude<span class=\"token punctuation\">.</span>Show</span></code></pre></div>\n<p>These are the actions players can take to move the game state around.</p>\n<p><a href=\"https://github.com/franleplant/plutus-pioneer-program-fork/blob/rock-paper-scissors/code/week07/src/RPS/GameRedeemer.hs\">GameRedeemer.hs</a></p>\n<h2 id=\"on-chain-validator-state-machine\" style=\"position:relative;\">On-chain validator: State Machine<a href=\"#on-chain-validator-state-machine\" aria-label=\"on chain validator state machine permalink\" class=\"header-anchor after\">#</a></h2>\n<p>This is the abstraction on top of a regular validator script that Plutus provides in order\nto model the common case of a State Machine.</p>\n<p>We are only going to show one of the main happy paths, player 1 plays,\nthen player 2 plays, finally player 1 reveals and win:</p>\n<div class=\"gatsby-highlight\" data-language=\"haskell\"><pre class=\"language-haskell\"><code class=\"language-haskell\"><span class=\"token comment\">-- this are arms of a haskell's case and we are doing pattern matching.</span>\n<span class=\"token comment\">-- (State0, Player2Play) -> State1</span>\n<span class=\"token comment\">-- this represents the valid transition from State0 where Player1</span>\n<span class=\"token comment\">-- played in secret to State1 where Player2 played (not secretly)</span>\n<span class=\"token punctuation\">(</span><span class=\"token constant\">State0</span> <span class=\"token hvariable\">player1ChoiceHash</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">GameRedeemer<span class=\"token punctuation\">.</span>Player2Play</span> <span class=\"token hvariable\">player2Choice</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">staked</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">-- each player needs to stake in order to play</span>\n  <span class=\"token comment\">-- this validates that State0 has 1xStake</span>\n  <span class=\"token operator\">|</span> <span class=\"token hvariable\">lovelaces</span> <span class=\"token hvariable\">staked</span> <span class=\"token operator\">==</span> <span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>stake</span> <span class=\"token hvariable\">game</span> <span class=\"token operator\">-></span>\n      <span class=\"token keyword\">let</span> <span class=\"token hvariable\">constraints</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">Constraints<span class=\"token punctuation\">.</span>mustBeSignedBy</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>player2</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;></span>\n                        <span class=\"token hvariable\">Constraints<span class=\"token punctuation\">.</span>mustValidateIn</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">to</span> <span class=\"token operator\">$</span> <span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>playDeadline</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span>\n          <span class=\"token hvariable\">datum</span>       <span class=\"token operator\">=</span> <span class=\"token constant\">State1</span> <span class=\"token hvariable\">player1ChoiceHash</span> <span class=\"token hvariable\">player2Choice</span>\n          <span class=\"token hvariable\">stake</span>       <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">lovelaceValueOf</span> <span class=\"token operator\">$</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>stake</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">-- we return the next state: State1 (plus its payload)</span>\n      <span class=\"token keyword\">in</span> <span class=\"token constant\">Just</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">constraints</span> <span class=\"token punctuation\">,</span> <span class=\"token constant\">State</span> <span class=\"token hvariable\">datum</span> <span class=\"token hvariable\">stake</span><span class=\"token punctuation\">)</span>\n\n\n<span class=\"token comment\">-- (State1, Player1RevealWin) -> StateFinal</span>\n<span class=\"token punctuation\">(</span><span class=\"token constant\">State1</span> <span class=\"token hvariable\">_</span> <span class=\"token hvariable\">_</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">GameRedeemer<span class=\"token punctuation\">.</span>Player1RevealWin</span> <span class=\"token hvariable\">_</span> <span class=\"token hvariable\">_</span><span class=\"token punctuation\">,</span> <span class=\"token hvariable\">staked</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">-- since both player played at this stage, the amount</span>\n  <span class=\"token comment\">-- of coins staked should be 2x stake</span>\n  <span class=\"token operator\">|</span> <span class=\"token hvariable\">lovelaces</span> <span class=\"token hvariable\">staked</span> <span class=\"token operator\">==</span> <span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>stake</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">-></span>\n      <span class=\"token keyword\">let</span> <span class=\"token hvariable\">constraints</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">Constraints<span class=\"token punctuation\">.</span>mustBeSignedBy</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>player1</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;></span>\n                        <span class=\"token hvariable\">Constraints<span class=\"token punctuation\">.</span>mustValidateIn</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">to</span> <span class=\"token operator\">$</span> <span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>revealDeadline</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&lt;></span>\n                        <span class=\"token hvariable\">Constraints<span class=\"token punctuation\">.</span>mustPayToPubKey</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>player1</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">lovelaceValueOf</span> <span class=\"token operator\">$</span> <span class=\"token number\">2</span> <span class=\"token operator\">*</span> <span class=\"token hvariable\">Game<span class=\"token punctuation\">.</span>stake</span> <span class=\"token hvariable\">game</span><span class=\"token punctuation\">)</span>\n      <span class=\"token comment\">-- we return the next state: StateFinal</span>\n      <span class=\"token keyword\">in</span> <span class=\"token constant\">Just</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">constraints</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">State</span> <span class=\"token constant\">StateFinal</span> <span class=\"token hvariable\">mempty</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p><a href=\"https://github.com/franleplant/plutus-pioneer-program-fork/blob/rock-paper-scissors/code/week07/src/RPS/Validator.hs\">Validator.hs</a></p>\n<p><code class=\"language-text\">constraints</code> are a Plutus primitive that lets you express checks for the incoming transaction,\nhave in mind that this validator runs whenever some trivial address is trying to consume one of its\nUTxOs, so in order to spend a UTxO the validator needs to agree with said action.</p>\n<p>In this case we are only allowing this particular state change to happen if the transaction\ntrying to be applied is signed by Player2 and it is done before the <code class=\"language-text\">playDeadline</code>.</p>\n<p>We return the next State defined in <code class=\"language-text\">datum</code> and we duplicate the <code class=\"language-text\">stake</code> amount of Ada\nbecause Player2 needs to <code class=\"language-text\">stake</code> or <code class=\"language-text\">bet</code> in order to participate.</p>\n<p>Additional checks can be done by implementing a <code class=\"language-text\">check</code> function, here is an\nexample of how we use it to add an extra check to the <code class=\"language-text\">Player1RevealWin</code> transition.\nWe simply check that the revealed choice that Player1 made actually wins Player2’s:</p>\n<div class=\"gatsby-highlight\" data-language=\"haskell\"><pre class=\"language-haskell\"><code class=\"language-haskell\"><span class=\"token hvariable\">check</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">State1</span> <span class=\"token hvariable\">player1ChoiceHash</span> <span class=\"token hvariable\">player2Choice</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">(</span><span class=\"token constant\">Player1RevealWin</span> <span class=\"token hvariable\">nonce</span> <span class=\"token hvariable\">player1Choice</span><span class=\"token punctuation\">)</span> <span class=\"token hvariable\">_</span> <span class=\"token operator\">=</span>\n    <span class=\"token hvariable\">traceIfFalse</span> <span class=\"token string\">\"player1 should reveal the original choice\"</span>\n      <span class=\"token punctuation\">(</span><span class=\"token hvariable\">player1ChoiceHash</span> <span class=\"token operator\">==</span> <span class=\"token hvariable\">presentedPlayer1ChoiceHash</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span>\n    <span class=\"token hvariable\">traceIfFalse</span> <span class=\"token string\">\"player1 beats player2\"</span>\n      <span class=\"token punctuation\">(</span><span class=\"token hvariable\">GameChoice<span class=\"token punctuation\">.</span>beats</span> <span class=\"token hvariable\">player1Choice</span> <span class=\"token hvariable\">player2Choice</span><span class=\"token punctuation\">)</span>\n        <span class=\"token keyword\">where</span>\n            <span class=\"token hvariable\">player1ChoiceString</span> <span class=\"token operator\">::</span> <span class=\"token constant\">ByteString</span>\n            <span class=\"token hvariable\">player1ChoiceString</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">case</span> <span class=\"token hvariable\">player1Choice</span> <span class=\"token keyword\">of</span>\n                <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>Rock</span>     <span class=\"token operator\">-></span> <span class=\"token hvariable\">rock</span>\n                <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>Paper</span>    <span class=\"token operator\">-></span> <span class=\"token hvariable\">paper</span>\n                <span class=\"token constant\">GameChoice<span class=\"token punctuation\">.</span>Scissors</span> <span class=\"token operator\">-></span> <span class=\"token hvariable\">scissors</span>\n\n            <span class=\"token hvariable\">presentedPlayer1ChoiceHash</span> <span class=\"token operator\">::</span> <span class=\"token constant\">ByteString</span>\n            <span class=\"token hvariable\">presentedPlayer1ChoiceHash</span> <span class=\"token operator\">=</span>  <span class=\"token hvariable\">choiceHash</span>\n                <span class=\"token keyword\">where</span>\n                    <span class=\"token hvariable\">choiceHash</span> <span class=\"token operator\">=</span> <span class=\"token hvariable\">sha2_256</span> <span class=\"token punctuation\">(</span><span class=\"token hvariable\">nonce</span> <span class=\"token operator\">`concatenate`</span> <span class=\"token hvariable\">player1ChoiceString</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>Note: I’ve omitted some details for clarity, check the <a href=\"https://github.com/franleplant/plutus-pioneer-program-fork/blob/rock-paper-scissors/code/week07/src/RPS/Validator.hs\">full code</a></p>\n<h2 id=\"off-chain-code\" style=\"position:relative;\">Off-chain code<a href=\"#off-chain-code\" aria-label=\"off chain code permalink\" class=\"header-anchor after\">#</a></h2>\n<p>Plutus is heavy on the Off-chain code, but it is safe to do so because the important constraints should\nalways be implemented on the <code class=\"language-text\">validators</code>.</p>\n<p>The off-chain code, also written in Haskell and that will be later allowed to be run in the browser simply\nallows two users to play this game. The first player <em>instantiates</em> the contract by playing secretly and\nadding a stake.</p>\n<p>Player2 plays by finding an open game and playing and staking.</p>\n<p>When the deadlines are passed a winner is decided and the reward (staked) is claimed.</p>\n<p>Nothing illegal should be allowed to happen because our on-chain code (validator) should only allow\ncertain valid transactions to happen and nothing else.</p>\n<p><a href=\"https://github.com/franleplant/plutus-pioneer-program-fork/blob/rock-paper-scissors/code/week07/src/RPS.hs\">off chain code</a></p>\n<h2 id=\"outro\" style=\"position:relative;\">Outro<a href=\"#outro\" aria-label=\"outro permalink\" class=\"header-anchor after\">#</a></h2>\n<p><a href=\"https://github.com/franleplant/plutus-pioneer-program-fork/tree/rock-paper-scissors/code/week07/src\">Check the full code here</a></p>\n<p>Cardano and Plutus are really fun and interesting and there is a lot of things coming their way\nthat make me super excited about.</p>\n<p>I’m anxious about actually deploying this dummy game to the main net and add a nice UI on top of it.</p>","fields":{"slug":"/cardano-smart-contract-game/","readingTime":{"text":"8 min read"}},"frontmatter":{"title":"Rock-paper-scissors game built in Cardano smart contracts","date":"August 10, 2021","description":" A quick high level overview of how you can write a state machine based smart contract in the upcoming Cardano's Plutus platform for Smart Contracts or Smart Transactions. ","tags":["haskell","cardano","plutus","blockchain","smart contracts","smart transactions","game","state machines","plutus pioneer program"],"seoFooter":null,"author":{"id":"franleplant","bio":"Tech Lead and Software developer with a degree in Engineering. Woodworker, all things Javascript, Rust and Software Architecture.","twitter":"franleplant","github":"https://github.com/franleplant","profilepicture":{"childImageSharp":{"fluid":{"base64":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAASCAIAAADUsmlHAAAACXBIWXMAAB2HAAAdhwGP5fFlAAACjUlEQVQ4y2P4jwH+/fsHJO/curV6xdKjhw9+//4NLogGGND4f//+BZKXL160MDVRUVLSUFZydbBbvHDBf2wAXfOfP3+AZENtjaWqVFGEx/L69HB7I3ERkUMHD8CNJmDzlo3rtrdn/Tww5/+p5Wtb8wUEBCZNnAA3GqdmiN9ePH86uTDmUG/h6vr0LT3Fdrqqpw8TYTNE89dPH84saL+3rPPlpinn5zcdn9Xw//sniDQ+zXCwdWLVqvL4iwtbTs6qPrd1KUgjqrXYNUMUndm9dk9P/obO/OkFYZeP7SVKM9DZf8GhcmDvriw/y3xvwy0tyetm9xw4fPT6tes/f/4iYDMwSJ88eRIREZ7oqDkh07cxL9HT1c3dw9va2nbv3v3IwcaAFlRv375taW0LDY2wtLZ0c7QzMzEys7T18w/KzMrOys5btmIlcmpjQNYJJFvbWgMCgyOjY3z9fH18/ULDIgoKivILimJi41NTUpOSU6/fuAm3nAE5bew9cNDR1T0qJiYkNAQIAgID0zOycnLzw8IjIyIiMzOz4uISdu3ag6IZYu3nz58mtdaWpkYFBwd4eXkFBASGhYUlJaeER0Z5eXsnJCSkpaVFRcVs2LABi+ZVyxafnVN3bUlzYrCHuZWVp6dHeHh4RGSUm7t7TEx0ampaRkYmMCw2bdqE0Ayhbt68GRcXN7+9/MrKnvq0MEtr26CgIP+AACtzE2cnR6CDMzKzkpJSQkPDb968hdAMSeuzZs92cnEODo+IiIqJjY2Ljo6JiYvPTolf3VGQnhgbGh4RFh7u6+tXXV2NHMBQzRMnTdTT03VydnRxdXVxdTMzM7GwsIgIDc5MjvPz9/f19fH29razs9+8eTNyPAMANpkgbLnsUSwAAAAASUVORK5CYII=","aspectRatio":1.1363636363636365,"src":"/static/3d0df698a9c84ca995878f7c2815d974/edb0e/franleplant-profile.png","srcSet":"/static/3d0df698a9c84ca995878f7c2815d974/69585/franleplant-profile.png 200w,\n/static/3d0df698a9c84ca995878f7c2815d974/497c6/franleplant-profile.png 400w,\n/static/3d0df698a9c84ca995878f7c2815d974/edb0e/franleplant-profile.png 620w","sizes":"(max-width: 620px) 100vw, 620px"}}}}}}},"pageContext":{"slug":"/cardano-smart-contract-game/","previous":{"fields":{"slug":"/flex-gap-in-unsupported-browsers/"},"frontmatter":{"title":"How to use CSS flex gap in unsupported browsers"}},"next":{"fields":{"slug":"/cardano-smart-transactions/"},"frontmatter":{"title":"Cardano will never have smart contracts"}}}},"staticQueryHashes":["1000388668","1219926595","914163225"]}